import{d as M,b as L,r as b,A as P,o as h,f as y,g as t,j as Y,w as m,v as f,L as D,m as p,E as v,i as C,M as F,K as x,N as A,D as q,H as E}from"./index-6f6749ac.js";import{a as k,G as V,S as R}from"./SelectGroupDate-04c3b3da.js";import{j as w}from"./jsonApi-71500902.js";import{f as S}from"./formApi-e583adde.js";import{S as T,g as $}from"./util.grid-e8996db9.js";import{F as G}from"./FtpService-c7f28024.js";import{_ as H}from"./CommonCode.vue_vue_type_script_setup_true_lang-ab59297e.js";import{F as U}from"./FileListUploader-afa9b1dc.js";import{d as c}from"./util.date-5697c534.js";import"./index-8d9b3034.js";class O{async getPopupList(s){return(await w("/bo/cs/getPopupList",s||{})).data}async getPopup(s){return(await w("/bo/cs/getPopup",s||{})).data}async setPopupList(s){return(await w("/bo/cs/setPopupList",s||{})).data}async insertPopup(s){return(await S("/bo/cs/insertPopup",s)).data}async updatePopup(s){return(await S("/bo/cs/updatePopup",s)).data}async deletePopup(s){return(await S("/bo/cs/getPopupList",s)).data}}const g=new O,B={id:"PopupDetail",class:"popup"},K={class:"popupWrap"},W=t("h3",null,"팝업 등록/수정",-1),j=t("span",{class:"icon"},"",-1),z=[j],X={class:"popT"},J=t("th",{class:"th required"},"팝업번호",-1),Q={class:"td"},Z={key:0},tt=t("th",{class:"th required"},"업체",-1),et={class:"td"},at=t("th",{class:"th"},"제목",-1),dt={class:"td"},ot=t("tr",null,[t("td",{colspan:"2",class:"td"},[t("div",{id:"popupEditor"})])],-1),st=t("th",{class:"th"},"파일번호",-1),nt={class:"td"},it=t("th",{class:"th"},"우선순위",-1),lt={class:"td"},rt=t("th",{class:"th"},"사용 여부",-1),pt={class:"td"},ut=t("th",{class:"th required"},"시작/종료일",-1),mt={class:"td"},ct={class:"btnWrap"},ft=M({__name:"PopupDetail",props:{data:{type:Object,required:!0}},emits:["set-close"],setup(I,{emit:s}){const e=I,n=L();e.data.strtDt||(e.data.strtDt=c.format(new Date,c.DATE_FORMAT)),e.data.endDt||(e.data.endDt=c.format(new Date,c.DATE_FORMAT)),e.data.useYn||(e.data.useYn="Y");const u=b({addFileList:[]}),_=b({editor:{},editorOption:{}}),r=()=>{e.data.popNo&&e.data.cmpId?g.getPopup({popNo:e.data.popNo,cmpId:e.data.cmpId}).then(d=>{e.data.popNo=d.data.popNo,e.data.cmpId=d.data.cmpId,e.data.cnts=d.data.cnts,e.data.fileList=d.data.fileList,o()},d=>{console.log(d)}):o()},o=()=>{_.editor=$.createEditor({name:"#popupEditor",cnts:e.data.cnts})},l=()=>{let d=$.makeFileData({name:"popup",props:e,data:u});d.addCount>0||d.delCount>0?G.uploadList(d.form).then(a=>{if(a.success)e.data.fileNo=a.data.fileNo,N();else return!1},a=>(console.log(a),!1)):N()},N=()=>{let d=new FormData;d.append("popNo",e.data.popNo),d.append("cmpId",e.data.cmpId+""),d.append("tit",e.data.tit+""),d.append("cnts",_.editor.getMarkdown()),d.append("fileNo",e.data.fileNo),d.append("prir",e.data.prir),d.append("useYn",e.data.useYn+""),d.append("strtDt",e.data.strtDt+""),d.append("endDt",e.data.endDt+""),d.append("linkRef",e.data.linkRef+""),d.append("modId",e.data.modId+""),d.append("modDt",e.data.modDt+""),d.append("regId",e.data.regId+""),d.append("regDt",e.data.regDt+""),(e.data.mode==="insert"?g.insertPopup:g.updatePopup)(d).then(a=>{a.success?location.reload():console.log(a)},a=>{console.log(a)})};return P(()=>{r()}),(d,a)=>(h(),y("div",B,[t("div",K,[W,t("div",{class:"close",onClick:a[0]||(a[0]=i=>s("set-close"))},z),t("form",{onSubmit:a[11]||(a[11]=Y(()=>{},["prevent"]))},[t("table",X,[t("tr",null,[J,t("td",Q,[m(t("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=i=>e.data.popNo=i),required:""},null,512),[[f,e.data.popNo]])])]),D(n).userInfo.cmpId=="kaisa"?(h(),y("tr",Z,[tt,t("td",et,[p(T,{cmpId:e.data.cmpId,required:!0,onSetCompany:a[2]||(a[2]=i=>{e.data.cmpId=i.cmpId})},null,8,["cmpId"])])])):v("",!0),t("tr",null,[at,t("td",dt,[m(t("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=i=>e.data.tit=i),maxlength:"200"},null,512),[[f,e.data.tit]])])]),ot,t("tr",null,[st,t("td",nt,[p(U,{name:"Popup",fileList:e.data.fileList,addFileList:u.addFileList,onSetFileList:a[4]||(a[4]=i=>{e.data.fileList=i}),onSetAddFileList:a[5]||(a[5]=i=>{u.addFileList=i})},null,8,["fileList","addFileList"])])]),t("tr",null,[it,t("td",lt,[m(t("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=i=>e.data.prir=i)},null,512),[[f,e.data.prir]])])]),t("tr",null,[rt,t("td",pt,[p(H,{cd:"YN_CD",model:e.data.useYn,onSetData:a[7]||(a[7]=i=>{e.data.useYn=i})},null,8,["model"])])]),t("tr",null,[ut,t("td",mt,[p(k,{name:["strtDt"],format:D(c).DATE_FORMAT,date:[e.data.strtDt],isAll:!1,timer:!0,onSetStartDate:a[8]||(a[8]=i=>{e.data.strtDt=i.date})},null,8,["format","date"]),C(" ~ "),p(k,{name:["endDt"],format:D(c).DATE_FORMAT,date:[e.data.endDt],isAll:!1,timer:!0,onSetStartDate:a[9]||(a[9]=i=>{e.data.endDt=i.date})},null,8,["format","date"])])])]),t("div",ct,[t("button",{type:"submit",onClick:l},"저장"),t("button",{type:"button",class:"gray",onClick:a[10]||(a[10]=i=>s("set-close"))},"취소")])],32)])]))}}),ht=["onSubmit","onKeyup"],Dt=t("legend",null,"검색",-1),_t=t("colgroup",null,[t("col",{width:"80"}),t("col",{width:"30%"}),t("col",{width:"80"}),t("col",{width:"*"})],-1),gt=t("th",null,"검색조건",-1),bt={colspan:"3"},yt={key:0},It=t("th",null,"업체ID",-1),wt={colspan:"3"},St={class:"audit"},vt=t("th",null,"수정기간",-1),kt={colspan:"3"},$t=t("th",null,"등록일",-1),Nt={colspan:"3"},Mt=t("th",null,"수정ID",-1),Lt=t("th",null,"등록ID",-1),Pt={class:"btnWrap"},Yt=t("span",{class:"icon"},"",-1),Ct=t("button",{type:"submit",class:"button3"},[t("span",{class:"icon"},"")],-1),Tt=t("span",{class:"icon"},'"',-1),Ft=[Tt],xt={class:"totalCount"},At=t("div",{id:"popupGrid"},null,-1),Wt=M({__name:"Popup",setup(I){const s=L(),e=b({keyword:"",startModDt:"",endModDt:"",regDt:"",regId:"",modId:"",cmpId:""}),n=b({popupGrid:{},required:["popNo","strtDt","endDt"],totalCount:0,list:[],audit:!1,detailShow:!1,detail:{popNo:0,cmpId:"",tit:"",cnts:"",fileNo:0,prir:0,useYn:"Y",strtDt:"",endDt:"",linkRef:"",modId:"",modDt:"",regId:"",regDt:"",mode:""}}),u=()=>{g.getPopupList(e).then(r=>{n.totalCount=r.count?r.count:0,n.list=r.data,n.popupGrid.resetData(r.data,{})},r=>{console.log(r)})},_=()=>{n.detail={popNo:0,cmpId:"",tit:"",cnts:"",fileNo:0,prir:0,useYn:"",strtDt:"",endDt:"",linkRef:"",modId:"",modDt:"",regId:"",regDt:"",mode:"insert"},n.detailShow=!0};return P(()=>{n.popupGrid=new V({el:document.getElementById("popupGrid"),columns:[{header:"팝업번호",name:"popNo",sortable:!0,width:100,align:"right",disabled:!0,validation:{dataType:"number",required:!1},editor:"text"},{header:"업체ID",name:"cmpId",sortable:!0,width:100,align:"left",disabled:!0,hidden:s.userInfo.cmpId!="kaisa",editor:"text"},{header:"제목",name:"tit",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!0},editor:"text"},{header:"파일번호",name:"fileNo",sortable:!0,width:100,align:"right",disabled:!0,validation:{dataType:"number",required:!0},editor:"text"},{header:"우선순위",name:"prir",sortable:!0,width:100,align:"right",disabled:!0,validation:{dataType:"number",required:!0},editor:"text"},{header:"사용 여부",name:"useYn",width:120,align:"left",sortable:!0,defaultValue:"Y",disabled:!0,validation:{dataType:"string",required:!0},formatter:"listItemText",editor:{type:"select",options:{listItems:s.codeList.YN_CD}}},{header:"시작일시",name:"strtDt",sortable:!0,width:120,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:{type:"datePicker",options:{format:"yyyy-MM-dd HH:mm"}}},{header:"종료일시",name:"endDt",sortable:!0,width:120,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:{type:"datePicker",options:{format:"yyyy-MM-dd HH:mm"}}},{header:"연동참조",name:"linkRef",align:"left",sortable:!0,width:110,disabled:!0,hidden:s.userInfo.cmpId!="kaisa"},{header:"수정 ID",name:"modId",align:"left",sortable:!0,width:110,disabled:!0},{header:"수정 일시",name:"modDt",align:"left",sortable:!0,width:120,disabled:!0},{header:"등록 ID",name:"regId",align:"left",sortable:!0,width:110,disabled:!0},{header:"등록 일시",name:"regDt",align:"left",sortable:!0,width:120,disabled:!0}],scrollX:!0,scrollY:!0,minBodyHeight:200,bodyHeight:468,columnOptions:{resizable:!0},minRowHeight:40,rowHeight:40,header:{height:40}}),n.popupGrid.on("dblclick",r=>{r.columnName&&n.list[r.rowKey]&&(n.detail=n.list[r.rowKey],n.detailShow=!0)}),u()}),(r,o)=>(h(),y(E,null,[t("form",{class:"search",onSubmit:Y(u,["prevent"]),onKeyup:A(u,["enter"])},[t("fieldset",null,[Dt,t("table",null,[_t,t("tbody",null,[t("tr",null,[gt,t("td",bt,[m(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>e.keyword=l)},null,512),[[f,e.keyword]])])]),D(s).userInfo.cmpId=="kaisa"?(h(),y("tr",yt,[It,t("td",wt,[p(T,{cmpId:e.cmpId,onSetCompany:o[1]||(o[1]=l=>{e.cmpId=l.cmpId})},null,8,["cmpId"])])])):v("",!0)]),m(t("tbody",St,[t("tr",null,[vt,t("td",kt,[p(R,{name:["startModDt","endModDt"],format:"YYYY-MM-DD",date:[e.startModDt,e.endModDt],onSetStartDate:o[2]||(o[2]=l=>{e.startModDt=l.date}),onSetEndDate:o[3]||(o[3]=l=>{e.endModDt=l.date})},null,8,["date"])])]),t("tr",null,[$t,t("td",Nt,[p(k,{name:["regDt"],format:"YYYY-MM-DD",date:[e.regDt],onSetStartDate:o[4]||(o[4]=l=>{e.regDt=l.date})},null,8,["date"])])]),t("tr",null,[Mt,t("td",null,[m(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=l=>e.modId=l)},null,512),[[f,e.modId]])]),Lt,t("td",null,[m(t("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=l=>e.regId=l)},null,512),[[f,e.regId]])])])],512),[[F,n.audit]])])]),t("div",Pt,[t("span",{class:"crud"},[t("button",{type:"button",class:"button add",onClick:_},[Yt,C("등록")])]),t("button",{type:"button",class:"audit",onClick:o[7]||(o[7]=l=>n.audit=!n.audit)},"상세조회"),Ct,t("button",{type:"reset",onClick:o[8]||(o[8]=l=>D($).reload())},Ft),t("div",xt,"총 "+x(n.totalCount)+"건",1)])],40,ht),At,n.detailShow?(h(),q(ft,{key:0,data:n.detail,onSetClose:o[9]||(o[9]=l=>{n.detailShow=!1})},null,8,["data"])):v("",!0)],64))}});export{Wt as default};
