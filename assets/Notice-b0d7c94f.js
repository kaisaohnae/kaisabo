import{d as M,b as L,r as g,A as Y,o as f,f as y,g as t,j as C,L as h,m as u,E as S,w as m,v as _,i as T,M as x,K as A,N as E,D as q,H as G}from"./index-6f6749ac.js";import{a as v,G as H,S as V}from"./SelectGroupDate-04c3b3da.js";import{j as N}from"./jsonApi-71500902.js";import{f as I}from"./formApi-e583adde.js";import{S as F,g as $}from"./util.grid-e8996db9.js";import{F as O}from"./FtpService-c7f28024.js";import{_ as U}from"./CommonCode.vue_vue_type_script_setup_true_lang-ab59297e.js";import{F as B}from"./FileListUploader-afa9b1dc.js";import{d as p}from"./util.date-5697c534.js";import"./index-8d9b3034.js";class K{async getNoticeList(d){return(await N("/bo/cs/getNoticeList",d||{})).data}async getNotice(d){return(await N("/bo/cs/getNotice",d||{})).data}async setNoticeList(d){return(await N("/bo/cs/setNoticeList",d||{})).data}async insertNotice(d){return(await I("/bo/cs/insertNotice",d)).data}async updateNotice(d){return(await I("/bo/cs/updateNotice",d)).data}async deleteNotice(d){return(await I("/bo/cs/getNoticeList",d)).data}}const b=new K,R={id:"noticeDetail",class:"popup"},W={class:"popupWrap"},P=t("h3",null,"공지사항 등록/수정",-1),j=t("span",{class:"icon"},"",-1),z=[j],X={class:"popT"},J={key:0},Q=t("th",{class:"th"},"업체ID",-1),Z={class:"td"},tt=t("th",{class:"th required"},"제목",-1),et={class:"td"},at=t("th",{class:"th"},"사용여부",-1),ot={class:"td"},dt=t("th",{class:"th"},"시작/종료일",-1),st={class:"td"},it=t("th",{class:"th"},"파일",-1),nt={class:"td"},lt=t("tr",null,[t("td",{colspan:"2",class:"td"},[t("div",{id:"noticeEditor"})])],-1),rt={class:"btnWrap"},ut=M({__name:"NoticeDetail",props:{data:{type:Object,required:!0}},emits:["set-close"],setup(w,{emit:d}){const e=w,s=L();e.data.strtDt||(e.data.strtDt=p.format(new Date,p.DATE_FORMAT)),e.data.endDt||(e.data.endDt=p.format(new Date,p.DATE_FORMAT)),e.data.useYn||(e.data.useYn="Y");const c=g({addFileList:[]}),D=g({editor:{},editorOption:{}}),r=()=>{e.data.notiNo?b.getNotice({notiNo:e.data.notiNo}).then(i=>{e.data.fileNo=i.data.fileNo,e.data.cnts=i.data.cnts,e.data.fileList=i.data.fileList,o()},i=>{console.log(i)}):o()},o=()=>{D.editor=$.createEditor({name:"#noticeEditor",cnts:e.data.cnts})},n=()=>{let i=$.makeFileData({name:"notice",props:e,data:c});i.addCount>0||i.delCount>0?O.uploadList(i.form).then(a=>{if(a.success)e.data.fileNo=a.data.fileNo,k();else return!1},a=>(console.log(a),!1)):k()},k=()=>{let i=new FormData;i.append("notiNo",e.data.notiNo+""),i.append("cmpId",e.data.cmpId),i.append("tit",e.data.tit),i.append("fileNo",e.data.fileNo+""),i.append("useYn",e.data.useYn),i.append("strtDt",e.data.strtDt),i.append("endDt",e.data.endDt),i.append("cnts",D.editor.getMarkdown()),(e.data.mode==="insert"?b.insertNotice:b.updateNotice)(i).then(a=>{a.success?location.reload():console.log(a)},a=>{console.log(a)})};return Y(()=>{r()}),(i,a)=>(f(),y("div",R,[t("div",W,[P,t("div",{class:"close",onClick:a[0]||(a[0]=l=>d("set-close"))},z),t("form",{onSubmit:a[9]||(a[9]=C(()=>{},["prevent"]))},[t("table",X,[h(s).userInfo.cmpId=="kaisa"?(f(),y("tr",J,[Q,t("td",Z,[u(F,{cmpId:e.data.cmpId,onSetCompany:a[1]||(a[1]=l=>{e.data.cmpId=l.cmpId})},null,8,["cmpId"])])])):S("",!0),t("tr",null,[tt,t("td",et,[m(t("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=l=>e.data.tit=l),minlength:"5",maxlength:"100"},null,512),[[_,e.data.tit]])])]),t("tr",null,[at,t("td",ot,[u(U,{cd:"YN_CD",model:e.data.useYn,onSetData:a[3]||(a[3]=l=>{e.data.useYn=l})},null,8,["model"])])]),t("tr",null,[dt,t("td",st,[u(v,{name:["strtDt"],format:h(p).DATE_FORMAT,date:[e.data.strtDt],isAll:!1,timer:!0,onSetStartDate:a[4]||(a[4]=l=>{e.data.strtDt=l.date})},null,8,["format","date"]),T(" ~ "),u(v,{name:["endDt"],format:h(p).DATE_FORMAT,date:[e.data.endDt],isAll:!1,timer:!0,onSetStartDate:a[5]||(a[5]=l=>{e.data.endDt=l.date})},null,8,["format","date"])])]),t("tr",null,[it,t("td",nt,[u(B,{name:"notice",fileList:e.data.fileList,addFileList:c.addFileList,onSetFileList:a[6]||(a[6]=l=>{e.data.fileList=l}),onSetAddFileList:a[7]||(a[7]=l=>{c.addFileList=l})},null,8,["fileList","addFileList"])])]),lt]),t("div",rt,[t("button",{type:"submit",onClick:n},"저장"),t("button",{type:"button",class:"gray",onClick:a[8]||(a[8]=l=>d("set-close"))},"취소")])],32)])]))}}),ct=["onSubmit","onKeyup"],pt=t("legend",null,"검색",-1),mt=t("colgroup",null,[t("col",{width:"80"}),t("col",{width:"30%"}),t("col",{width:"80"}),t("col",{width:"*"})],-1),ft=t("th",null,"검색조건",-1),ht={colspan:"3"},Dt={key:0},_t=t("th",null,"업체ID",-1),bt={colspan:"3"},gt={class:"audit"},yt=t("th",null,"수정기간",-1),wt={colspan:"3"},Nt=t("th",null,"등록일",-1),It={colspan:"3"},St=t("th",null,"수정ID",-1),vt=t("th",null,"등록ID",-1),$t={class:"btnWrap"},kt=t("span",{class:"icon"},"",-1),Mt=t("button",{type:"submit",class:"button3"},[t("span",{class:"icon"},"")],-1),Lt=t("span",{class:"icon"},'"',-1),Yt=[Lt],Ct={class:"totalCount"},Tt=t("div",{id:"noticeGrid"},null,-1),Bt=M({__name:"Notice",setup(w){const d=L(),e=g({keyword:"",startModDt:"",endModDt:"",regDt:"",regId:"",modId:"",cmpId:""}),s=g({noticeGrid:{},totalCount:0,list:[],audit:!1,detailShow:!1,detail:{notiNo:0,cmpId:"",tit:"",fileNo:0,useYn:"",strtDt:"",endDt:"",mode:""}}),c=()=>{b.getNoticeList(e).then(r=>{s.totalCount=r.count?r.count:0,s.list=r.data,s.noticeGrid.resetData(r.data,{})},r=>{console.log(r)})},D=()=>{s.detail={notiNo:0,cmpId:"",tit:"",fileNo:0,useYn:"",strtDt:"",endDt:"",mode:"insert"},s.detailShow=!0};return Y(()=>{s.noticeGrid=new H({el:document.getElementById("noticeGrid"),columns:[{header:"공지 번호",name:"notiNo",sortable:!0,width:100,align:"right",disabled:!0,validation:{dataType:"number",required:!1},editor:"text"},{header:"업체ID",name:"cmpId",sortable:!0,width:100,align:"left",disabled:!0,editor:"text",hidden:d.userInfo.cmpId!="kaisa"},{header:"제목",name:"tit",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!0},editor:"text"},{header:"파일번호",name:"fileNo",sortable:!0,width:100,align:"right",disabled:!0,hidden:!0,validation:{dataType:"number",required:!0},editor:"text"},{header:"우선순위",name:"prir",sortable:!0,width:100,align:"right",disabled:!0,hidden:!0,validation:{dataType:"number",required:!0},editor:"text"},{header:"사용 여부",name:"useYn",width:120,align:"left",sortable:!0,defaultValue:"Y",disabled:!0,validation:{dataType:"string",required:!0},formatter:"listItemText",editor:{type:"select",options:{listItems:d.codeList.YN_CD}}},{header:"시작일시",name:"strtDt",sortable:!0,width:120,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:{type:"datePicker",options:{format:"yyyy-MM-dd HH:mm"}}},{header:"종료일시",name:"endDt",sortable:!0,width:120,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:{type:"datePicker",options:{format:"yyyy-MM-dd HH:mm"}}},{header:"연동참조",name:"linkRef",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!0},editor:"text",hidden:d.userInfo.cmpId!="kaisa"},{header:"수정 ID",name:"modId",align:"left",sortable:!0,width:110,disabled:!0},{header:"수정 일시",name:"modDt",align:"left",sortable:!0,width:120,disabled:!0},{header:"등록 ID",name:"regId",align:"left",sortable:!0,width:110,disabled:!0},{header:"등록 일시",name:"regDt",align:"left",sortable:!0,width:120,disabled:!0}],scrollX:!0,scrollY:!0,minBodyHeight:200,bodyHeight:468,columnOptions:{resizable:!0},minRowHeight:40,rowHeight:40,header:{height:40}}),s.noticeGrid.on("dblclick",r=>{r.columnName&&s.list[r.rowKey]&&(s.detail=s.list[r.rowKey],s.detailShow=!0)}),c()}),(r,o)=>(f(),y(G,null,[t("form",{class:"search",onSubmit:C(c,["prevent"]),onKeyup:E(c,["enter"])},[t("fieldset",null,[pt,t("table",null,[mt,t("tbody",null,[t("tr",null,[ft,t("td",ht,[m(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>e.keyword=n)},null,512),[[_,e.keyword]])])]),h(d).userInfo.cmpId=="kaisa"?(f(),y("tr",Dt,[_t,t("td",bt,[u(F,{cmpId:e.cmpId,onSetCompany:o[1]||(o[1]=n=>{e.cmpId=n.cmpId})},null,8,["cmpId"])])])):S("",!0)]),m(t("tbody",gt,[t("tr",null,[yt,t("td",wt,[u(V,{name:["startModDt","endModDt"],format:"YYYY-MM-DD",date:[e.startModDt,e.endModDt],onSetStartDate:o[2]||(o[2]=n=>{e.startModDt=n.date}),onSetEndDate:o[3]||(o[3]=n=>{e.endModDt=n.date})},null,8,["date"])])]),t("tr",null,[Nt,t("td",It,[u(v,{name:["regDt"],format:"YYYY-MM-DD",date:[e.regDt],onSetStartDate:o[4]||(o[4]=n=>{e.regDt=n.date})},null,8,["date"])])]),t("tr",null,[St,t("td",null,[m(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=n=>e.modId=n)},null,512),[[_,e.modId]])]),vt,t("td",null,[m(t("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=n=>e.regId=n)},null,512),[[_,e.regId]])])])],512),[[x,s.audit]])])]),t("div",$t,[t("span",{class:"crud"},[t("button",{type:"button",class:"button add",onClick:D},[kt,T("등록")])]),t("button",{type:"button",class:"audit",onClick:o[7]||(o[7]=n=>s.audit=!s.audit)},"상세조회"),Mt,t("button",{type:"reset",onClick:o[8]||(o[8]=n=>h($).reload())},Yt),t("div",Ct,"총 "+A(s.totalCount)+"건",1)])],40,ct),Tt,s.detailShow?(f(),q(ut,{key:0,data:s.detail,onSetClose:o[9]||(o[9]=n=>{s.detailShow=!1})},null,8,["data"])):S("",!0)],64))}});export{Bt as default};
