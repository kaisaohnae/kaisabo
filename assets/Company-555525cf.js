import{d as v,b as x,r as I,A as S,o as c,f as y,g as t,j as q,L as C,m,E as w,w as r,v as u,M as k,i as L,K as U,N as A,D as M,H as T}from"./index-6f6749ac.js";import{G as V,S as F,a as Y}from"./SelectGroupDate-04c3b3da.js";import{j as _}from"./jsonApi-71500902.js";import{f as D}from"./formApi-e583adde.js";import{S as N,g as $}from"./util.grid-e8996db9.js";import{F as R}from"./FtpService-c7f28024.js";import{_ as z}from"./CommonCode.vue_vue_type_script_setup_true_lang-ab59297e.js";import{F as G}from"./FileListUploader-afa9b1dc.js";import{d as h}from"./util.date-5697c534.js";import{S as B}from"./SelectJuso-b2884c9e.js";import"./index-8d9b3034.js";class E{async getCompanyList(l){return(await _("/bo/mb/getCompanyList",l||{})).data}async getCompany(l){return(await _("/bo/mb/getCompany",l||{})).data}async setCompanyList(l){return(await _("/bo/mb/setCompanyList",l||{})).data}async insertCompany(l){return(await D("/bo/mb/insertCompany",l)).data}async updateCompany(l){return(await D("/bo/mb/updateCompany",l)).data}async deleteCompany(l){return(await D("/bo/mb/getCompanyList",l)).data}}const f=new E,K={id:"CompanyDetail",class:"popup"},H={class:"popupWrap"},O=t("h3",null,"업체 등록/수정",-1),W=t("span",{class:"icon"},"",-1),P=[W],j={class:"popT"},J={key:0},X=t("th",{class:"th required"},"업체",-1),Q={class:"td"},Z=t("th",{class:"th required"},"업체구분코드",-1),tt={class:"td"},et=t("th",{class:"th required"},"업체명",-1),dt={class:"td"},at=t("th",{class:"th required"},"사업자등록번호",-1),ot={class:"td"},st=t("th",{class:"th"},"파일번호",-1),lt={class:"td"},nt=t("th",{class:"th required"},"주소",-1),it={class:"td"},rt=t("th",{class:"th required"},"상세주소",-1),ut={class:"td"},pt=t("th",{class:"th required"},"위도",-1),mt={class:"td"},ct=t("th",{class:"th required"},"경도",-1),ht={class:"td"},ft=t("th",{class:"th"},"사이트URL",-1),yt={class:"td"},bt=t("th",{class:"th required"},"전화번호",-1),gt={class:"td"},_t=t("th",{class:"th"},"비고",-1),Dt={class:"td"},It={class:"btnWrap"},Ct=v({__name:"CompanyDetail",props:{data:{type:Object,required:!0}},emits:["set-close"],setup(b,{emit:l}){const e=b,n=x();e.data.strtDt||(e.data.strtDt=h.format(new Date,h.DATE_FORMAT)),e.data.endDt||(e.data.endDt=h.format(new Date,h.DATE_FORMAT)),e.data.useYn||(e.data.useYn="Y");const p=I({addFileList:[]}),g=()=>{e.data.cmpId&&f.getCompany({cmpId:e.data.cmpId}).then(d=>{e.data.cmpId=d.data.cmpId,e.data.cnts=d.data.cnts,e.data.fileList=d.data.fileList},d=>{console.log(d)})},i=()=>{let d=$.makeFileData({name:"company",props:e,data:p});d.addCount>0||d.delCount>0?R.uploadList(d.form).then(a=>{if(a.success)e.data.fileNo=a.data.fileNo,s();else return!1},a=>(console.log(a),!1)):s()},s=()=>{let d=new FormData;d.append("cmpId",e.data.cmpId+""),d.append("cmpDivCd",e.data.cmpDivCd+""),d.append("cmpNm",e.data.cmpNm+""),d.append("bizno",e.data.bizno+""),d.append("fileNo",e.data.fileNo),d.append("addr",e.data.addr+""),d.append("dtlAddr",e.data.dtlAddr+""),d.append("lttd",e.data.lttd+""),d.append("lotd",e.data.lotd+""),d.append("steUrl",e.data.steUrl+""),d.append("telNo",e.data.telNo+""),d.append("note",e.data.note+""),d.append("linkRef",e.data.linkRef+""),d.append("modId",e.data.modId+""),d.append("modDt",e.data.modDt+""),d.append("regId",e.data.regId+""),d.append("regDt",e.data.regDt+""),(e.data.mode==="insert"?f.insertCompany:f.updateCompany)(d).then(a=>{a.success?location.reload():console.log(a)},a=>{console.log(a)})};return S(()=>{g()}),(d,a)=>(c(),y("div",K,[t("div",H,[O,t("div",{class:"close",onClick:a[0]||(a[0]=o=>l("set-close"))},P),t("form",{onSubmit:a[15]||(a[15]=q(()=>{},["prevent"]))},[t("table",j,[C(n).userInfo.cmpId=="kaisa"?(c(),y("tr",J,[X,t("td",Q,[m(N,{cmpId:e.data.cmpId,required:!0,onSetCompany:a[1]||(a[1]=o=>{e.data.cmpId=o.cmpId})},null,8,["cmpId"])])])):w("",!0),t("tr",null,[Z,t("td",tt,[m(z,{cd:"CMP_DIV_CD",model:e.data.cmpDivCd,onSetData:a[2]||(a[2]=o=>{e.data.cmpDivCd=o})},null,8,["model"])])]),t("tr",null,[et,t("td",dt,[r(t("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=o=>e.data.cmpNm=o),maxlength:"100",required:""},null,512),[[u,e.data.cmpNm]])])]),t("tr",null,[at,t("td",ot,[r(t("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=o=>e.data.bizno=o),maxlength:"50",required:""},null,512),[[u,e.data.bizno]])])]),t("tr",null,[st,t("td",lt,[m(G,{name:"Company",fileList:e.data.fileList,addFileList:p.addFileList,onSetFileList:a[5]||(a[5]=o=>{e.data.fileList=o}),onSetAddFileList:a[6]||(a[6]=o=>{p.addFileList=o})},null,8,["fileList","addFileList"])])]),t("tr",null,[nt,t("td",it,[m(B,{addr:e.data.addr,required:!0,maxlength:200,onSetAddr:a[7]||(a[7]=o=>{o.roadAddr?e.data.addr=o.roadAddr:e.data.addr=o.addr,e.data.lttd=o.lttd,e.data.lotd=o.lotd})},null,8,["addr"])])]),t("tr",null,[rt,t("td",ut,[r(t("input",{type:"text","onUpdate:modelValue":a[8]||(a[8]=o=>e.data.dtlAddr=o),maxlength:"200",required:""},null,512),[[u,e.data.dtlAddr]])])]),t("tr",null,[pt,t("td",mt,[r(t("input",{type:"text","onUpdate:modelValue":a[9]||(a[9]=o=>e.data.lttd=o),maxlength:"null",required:""},null,512),[[u,e.data.lttd]])])]),t("tr",null,[ct,t("td",ht,[r(t("input",{type:"text","onUpdate:modelValue":a[10]||(a[10]=o=>e.data.lotd=o),maxlength:"null",required:""},null,512),[[u,e.data.lotd]])])]),t("tr",null,[ft,t("td",yt,[r(t("input",{type:"text","onUpdate:modelValue":a[11]||(a[11]=o=>e.data.steUrl=o),maxlength:"100"},null,512),[[u,e.data.steUrl]])])]),t("tr",null,[bt,t("td",gt,[r(t("input",{type:"text","onUpdate:modelValue":a[12]||(a[12]=o=>e.data.telNo=o),maxlength:"60",required:""},null,512),[[u,e.data.telNo]])])]),t("tr",null,[_t,t("td",Dt,[r(t("input",{type:"text","onUpdate:modelValue":a[13]||(a[13]=o=>e.data.note=o),maxlength:"200"},null,512),[[u,e.data.note]])])])]),t("div",It,[t("button",{type:"submit",onClick:i},"저장"),t("button",{type:"button",class:"gray",onClick:a[14]||(a[14]=o=>l("set-close"))},"취소")])],32)])]))}}),wt=["onSubmit","onKeyup"],vt=t("legend",null,"검색",-1),xt=t("colgroup",null,[t("col",{width:"80"}),t("col",{width:"30%"}),t("col",{width:"80"}),t("col",{width:"*"})],-1),St=t("th",null,"검색조건",-1),qt={colspan:"3"},Nt={key:0},$t=t("th",null,"업체ID",-1),kt={colspan:"3"},Lt={class:"audit"},Ut=t("th",null,"수정기간",-1),At={colspan:"3"},Mt=t("th",null,"등록일",-1),Tt={colspan:"3"},Vt=t("th",null,"수정ID",-1),Ft=t("th",null,"등록ID",-1),Yt={class:"btnWrap"},Rt=t("span",{class:"icon"},"",-1),zt=t("button",{type:"submit",class:"button3"},[t("span",{class:"icon"},"")],-1),Gt=t("span",{class:"icon"},'"',-1),Bt=[Gt],Et={class:"totalCount"},Kt=t("div",{id:"companyGrid"},null,-1),de=v({__name:"Company",setup(b){const l=x(),e=I({keyword:"",startModDt:"",endModDt:"",regDt:"",regId:"",modId:"",cmpId:""}),n=I({companyGrid:{},required:["cmpDivCd","cmpNm","bizno","addr","dtlAddr","lttd","lotd","telNo"],totalCount:0,list:[],audit:!1,detailShow:!1,detail:{cmpId:"",cmpDivCd:"",cmpNm:"",bizno:"",fileNo:0,addr:"",dtlAddr:"",lttd:"",lotd:"",steUrl:"",telNo:"",note:"",linkRef:"",modId:"",modDt:"",regId:"",regDt:"",mode:""}}),p=()=>{f.getCompanyList(e).then(i=>{n.totalCount=i.count?i.count:0,n.list=i.data,n.companyGrid.resetData(i.data,{})},i=>{console.log(i)})},g=()=>{n.detail={cmpId:"",cmpDivCd:"",cmpNm:"",bizno:"",fileNo:0,addr:"",dtlAddr:"",lttd:"",lotd:"",steUrl:"",telNo:"",note:"",linkRef:"",modId:"",modDt:"",regId:"",regDt:"",mode:"insert"},n.detailShow=!0};return S(()=>{n.companyGrid=new V({el:document.getElementById("companyGrid"),columns:[{header:"업체ID",name:"cmpId",sortable:!0,width:100,align:"left",disabled:!0,hidden:l.userInfo.cmpId!="kaisa",editor:"text"},{header:"업체구분코드",name:"cmpDivCd",width:120,align:"left",sortable:!0,disabled:!0,validation:{dataType:"string",required:!1},formatter:"listItemText",editor:{type:"select",options:{listItems:l.codeList.CMP_DIV_CD}}},{header:"업체명",name:"cmpNm",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"사업자등록번호",name:"bizno",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"파일번호",name:"fileNo",sortable:!0,width:100,align:"right",disabled:!0,validation:{dataType:"number",required:!0},editor:"text"},{header:"주소",name:"addr",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"상세주소",name:"dtlAddr",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"위도",name:"lttd",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"경도",name:"lotd",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"사이트URL",name:"steUrl",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!0},editor:"text"},{header:"전화번호",name:"telNo",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!1},editor:"text"},{header:"비고",name:"note",sortable:!0,width:100,align:"left",disabled:!0,validation:{dataType:"string",required:!0},editor:"text"},{header:"연동참조",name:"linkRef",align:"left",sortable:!0,width:110,disabled:!0,hidden:l.userInfo.cmpId!="kaisa"},{header:"수정ID",name:"modId",align:"left",sortable:!0,width:110,disabled:!0},{header:"수정일시",name:"modDt",align:"left",sortable:!0,width:120,disabled:!0},{header:"등록ID",name:"regId",align:"left",sortable:!0,width:110,disabled:!0},{header:"등록일시",name:"regDt",align:"left",sortable:!0,width:120,disabled:!0}],scrollX:!0,scrollY:!0,minBodyHeight:200,bodyHeight:468,columnOptions:{resizable:!0},minRowHeight:40,rowHeight:40,header:{height:40}}),n.companyGrid.on("dblclick",i=>{i.columnName&&n.list[i.rowKey]&&(n.detail=n.list[i.rowKey],n.detailShow=!0)}),p()}),(i,s)=>(c(),y(T,null,[t("form",{class:"search",onSubmit:q(p,["prevent"]),onKeyup:A(p,["enter"])},[t("fieldset",null,[vt,t("table",null,[xt,t("tbody",null,[t("tr",null,[St,t("td",qt,[r(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=d=>e.keyword=d)},null,512),[[u,e.keyword]])])]),C(l).userInfo.cmpId=="kaisa"?(c(),y("tr",Nt,[$t,t("td",kt,[m(N,{cmpId:e.cmpId,onSetCompany:s[1]||(s[1]=d=>{e.cmpId=d.cmpId})},null,8,["cmpId"])])])):w("",!0)]),r(t("tbody",Lt,[t("tr",null,[Ut,t("td",At,[m(F,{name:["startModDt","endModDt"],format:"YYYY-MM-DD",date:[e.startModDt,e.endModDt],onSetStartDate:s[2]||(s[2]=d=>{e.startModDt=d.date}),onSetEndDate:s[3]||(s[3]=d=>{e.endModDt=d.date})},null,8,["date"])])]),t("tr",null,[Mt,t("td",Tt,[m(Y,{name:["regDt"],format:"YYYY-MM-DD",date:[e.regDt],onSetStartDate:s[4]||(s[4]=d=>{e.regDt=d.date})},null,8,["date"])])]),t("tr",null,[Vt,t("td",null,[r(t("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=d=>e.modId=d)},null,512),[[u,e.modId]])]),Ft,t("td",null,[r(t("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=d=>e.regId=d)},null,512),[[u,e.regId]])])])],512),[[k,n.audit]])])]),t("div",Yt,[t("span",{class:"crud"},[t("button",{type:"button",class:"button add",onClick:g},[Rt,L("등록")])]),t("button",{type:"button",class:"audit",onClick:s[7]||(s[7]=d=>n.audit=!n.audit)},"상세조회"),zt,t("button",{type:"reset",onClick:s[8]||(s[8]=d=>C($).reload())},Bt),t("div",Et,"총 "+U(n.totalCount)+"건",1)])],40,wt),Kt,n.detailShow?(c(),M(Ct,{key:0,data:n.detail,onSetClose:s[9]||(s[9]=d=>{n.detailShow=!1})},null,8,["data"])):w("",!0)],64))}});export{de as default};
